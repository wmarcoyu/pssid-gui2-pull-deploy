# pssid-gui2-pull-deploy
An Ansible script that pulls pre-built Docker images of pssid-gui2 from Docker Hub
and runs the services.

## Prerequisites
* Ansible is installed locally. If not, install it with
```
sudo apt-get update && sudo apt-get install ansible
```

## Usage
!!! **FOR DEVELOPERS**: change `dockerhub_username` in `playbook.yml` to 
an "official" Docker Hub user.

1. Open `playbook.yml` with a text editor.

Set the `install_path` entry, which is a directory that contains only 1 file,
`docker-compose.yml.j2`. **Caveat**: use absolute paths!

Then optionally edit the `pssid_gui_root_dir` entry, which is the root directory
of the application. Note that since the script starts the services directly out of
built Docker images, the root directory does not contain source code but only 
subdirectories and files that the application depends on. A brief overview is as 
follows.

`bin/` contains the `provision.sh` script.

`lib/` contains, `archivers/` and `tests/`, which contain the form
templates for the archivers and tests pages.

`mongo/` contains database files automatically managed by MongoDB that users do not
have to manage explicitly.

`output/` contains the files generated by the GUI, namely `hosts.ini` and 
`pssid_config.json`.

2. Run the script with
```
ansible-playbook --inventory inventory --ask-pass --ask-become-pass playbook.yml
```
which should generate a `docker-compose.yml` file out of the template, pull the 
images from Docker Hub, and start the services.
